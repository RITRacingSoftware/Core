\doxysection{/\+Users/solomonshulman/\+RITRacing/\+Core/src/driver/\+Src/clock.c File Reference}
\hypertarget{clock_8c}{}\label{clock_8c}\index{/Users/solomonshulman/RITRacing/Core/src/driver/Src/clock.c@{/Users/solomonshulman/RITRacing/Core/src/driver/Src/clock.c}}


Core clock library.  


{\ttfamily \#include "{}clock.\+h"{}}\newline
{\ttfamily \#include "{}core\+\_\+config.\+h"{}}\newline
{\ttfamily \#include $<$stdbool.\+h$>$}\newline
{\ttfamily \#include "{}stm32g4xx\+\_\+hal.\+h"{}}\newline
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{clock_8c_ad7f06124aad3399d2cae6790ea608cef}\label{clock_8c_ad7f06124aad3399d2cae6790ea608cef} 
void {\bfseries core\+\_\+clock\+\_\+\+ADC12\+\_\+init} ()
\begin{DoxyCompactList}\small\item\em Set the clocks for ADC1 and ADC2 to SYSCLK and enable them. \end{DoxyCompactList}\item 
\Hypertarget{clock_8c_a7601bbc868be45032c30a01c421aee79}\label{clock_8c_a7601bbc868be45032c30a01c421aee79} 
void {\bfseries core\+\_\+clock\+\_\+\+ADC345\+\_\+init} ()
\begin{DoxyCompactList}\small\item\em Set the clocks for ADC3, ADC4, and ADC5 to SYSCLK and enable them. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{clock_8c_a2b585a218aa24b5c50a5e92538e65615}{core\+\_\+clock\+\_\+\+FDCAN\+\_\+init}} (FDCAN\+\_\+\+Global\+Type\+Def \texorpdfstring{$\ast$}{*}can)
\begin{DoxyCompactList}\small\item\em Set FDCAN clock to PCLK1 and enable it. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{clock_8c_a4dfc43b43b5975284563a397da6a3d56}{core\+\_\+clock\+\_\+\+USART\+\_\+init}} (USART\+\_\+\+Type\+Def \texorpdfstring{$\ast$}{*}usart)
\begin{DoxyCompactList}\small\item\em Set a USART clock to PCLK1 and enable it. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{clock_8c_a8d0a10c2a2dd80900d18dcf3d1b2dae6}{core\+\_\+clock\+\_\+\+I2\+C\+\_\+init}} (I2\+C\+\_\+\+Type\+Def \texorpdfstring{$\ast$}{*}i2c)
\begin{DoxyCompactList}\small\item\em Set an I2C clock to PCLK1 and enable it. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{clock_8c_a909c55093b5c9d09f4edf03948a0642d}{core\+\_\+clock\+\_\+\+RTC\+\_\+init}} ()
\begin{DoxyCompactList}\small\item\em Enable the external 32.\+768k\+Hz oscillator and set the RTC clock to it. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{clock_8c_a8ac22b37088c49b5f266d0a00dcafb28}{core\+\_\+clock\+\_\+port\+\_\+init}} (GPIO\+\_\+\+Type\+Def \texorpdfstring{$\ast$}{*}port)
\begin{DoxyCompactList}\small\item\em Initializes port clock for selected port. \end{DoxyCompactList}\item 
uint8\+\_\+t \mbox{\hyperlink{clock_8c_a7e1523e05d1928674f334740d0e4ae03}{core\+\_\+clock\+\_\+generate\+\_\+params}} (uint32\+\_\+t src\+\_\+freq, uint32\+\_\+t target\+\_\+freq, uint8\+\_\+t \texorpdfstring{$\ast$}{*}n, uint8\+\_\+t \texorpdfstring{$\ast$}{*}m, uint8\+\_\+t \texorpdfstring{$\ast$}{*}r)
\begin{DoxyCompactList}\small\item\em Generate the settings for the N, M, and R dividers from the clock source frequency and the desired output frequency. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{clock_8c_afdfa75b3a589ff7de55fa846dc848d27}{core\+\_\+clock\+\_\+init}} ()
\begin{DoxyCompactList}\small\item\em Initialize the STM32\+G4\textquotesingle{}s core clocks. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Core clock library. 

This core library component is used to initialize peripheral clocks. Generally, it is only necessary to call \doxylink{clock_8c_afdfa75b3a589ff7de55fa846dc848d27}{core\+\_\+clock\+\_\+init()} from user code. Other clock initialization functions are called by the respective core module init function. 

\doxysubsection{Function Documentation}
\Hypertarget{clock_8c_a2b585a218aa24b5c50a5e92538e65615}\index{clock.c@{clock.c}!core\_clock\_FDCAN\_init@{core\_clock\_FDCAN\_init}}
\index{core\_clock\_FDCAN\_init@{core\_clock\_FDCAN\_init}!clock.c@{clock.c}}
\doxysubsubsection{\texorpdfstring{core\_clock\_FDCAN\_init()}{core\_clock\_FDCAN\_init()}}
{\footnotesize\ttfamily \label{clock_8c_a2b585a218aa24b5c50a5e92538e65615} 
void core\+\_\+clock\+\_\+\+FDCAN\+\_\+init (\begin{DoxyParamCaption}\item[{FDCAN\+\_\+\+Global\+Type\+Def \texorpdfstring{$\ast$}{*}}]{can}{}\end{DoxyParamCaption})}



Set FDCAN clock to PCLK1 and enable it. 

Initialize GPIO port clocks corresponding to CAN bus selected 
\begin{DoxyParams}{Parameters}
{\em can\+Num} & CAN bus to init \\
\hline
\end{DoxyParams}
\Hypertarget{clock_8c_a7e1523e05d1928674f334740d0e4ae03}\index{clock.c@{clock.c}!core\_clock\_generate\_params@{core\_clock\_generate\_params}}
\index{core\_clock\_generate\_params@{core\_clock\_generate\_params}!clock.c@{clock.c}}
\doxysubsubsection{\texorpdfstring{core\_clock\_generate\_params()}{core\_clock\_generate\_params()}}
{\footnotesize\ttfamily \label{clock_8c_a7e1523e05d1928674f334740d0e4ae03} 
uint8\+\_\+t core\+\_\+clock\+\_\+generate\+\_\+params (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{src\+\_\+freq}{, }\item[{uint32\+\_\+t}]{target\+\_\+freq}{, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{n}{, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{m}{, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{r}{}\end{DoxyParamCaption})}



Generate the settings for the N, M, and R dividers from the clock source frequency and the desired output frequency. 


\begin{DoxyParams}{Parameters}
{\em src\+\_\+freq} & Frequency of the clock source of the PLL, in kilohertz \\
\hline
{\em target\+\_\+freq} & Desired frequency of the R output of the PLL, in kilohertz \\
\hline
{\em n} & Location where the setting of the N divider is stored \\
\hline
{\em m} & Location where the setting of the M divider is stored \\
\hline
{\em r} & Location where the setting of the R divider is stored \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
The algorithm used here will try to maximize the frequency of the VCO output. Thus, in certain cases, the algorithm will not find an exact setting, even if one exists. 
\end{DoxyNote}

\begin{DoxyRetVals}{Return values}
{\em 0} & if the desired setting is outside of the frequency range of the VCO \\
\hline
{\em 1} & otherwise \\
\hline
\end{DoxyRetVals}
\Hypertarget{clock_8c_a8d0a10c2a2dd80900d18dcf3d1b2dae6}\index{clock.c@{clock.c}!core\_clock\_I2C\_init@{core\_clock\_I2C\_init}}
\index{core\_clock\_I2C\_init@{core\_clock\_I2C\_init}!clock.c@{clock.c}}
\doxysubsubsection{\texorpdfstring{core\_clock\_I2C\_init()}{core\_clock\_I2C\_init()}}
{\footnotesize\ttfamily \label{clock_8c_a8d0a10c2a2dd80900d18dcf3d1b2dae6} 
bool core\+\_\+clock\+\_\+\+I2\+C\+\_\+init (\begin{DoxyParamCaption}\item[{I2\+C\+\_\+\+Type\+Def \texorpdfstring{$\ast$}{*}}]{i2c}{}\end{DoxyParamCaption})}



Set an I2C clock to PCLK1 and enable it. 


\begin{DoxyParams}{Parameters}
{\em i2c\+\_\+num} & I2C module number \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em 1} & if i2c\+\_\+num is a valid I2C module \\
\hline
{\em 0} & otherwise \\
\hline
\end{DoxyRetVals}
\Hypertarget{clock_8c_afdfa75b3a589ff7de55fa846dc848d27}\index{clock.c@{clock.c}!core\_clock\_init@{core\_clock\_init}}
\index{core\_clock\_init@{core\_clock\_init}!clock.c@{clock.c}}
\doxysubsubsection{\texorpdfstring{core\_clock\_init()}{core\_clock\_init()}}
{\footnotesize\ttfamily \label{clock_8c_afdfa75b3a589ff7de55fa846dc848d27} 
bool core\+\_\+clock\+\_\+init (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}



Initialize the STM32\+G4\textquotesingle{}s core clocks. 

The SYSCLK frequency will be set to CORE\+\_\+\+CLOCK\+\_\+\+SYSCLK\+\_\+\+FREQ, which is given in kilohertz and defined in {\ttfamily core\+\_\+config.\+h}. This function is generally called immediately after HAL\+\_\+\+Init() in the user code.


\begin{DoxyRetVals}{Return values}
{\em 1} & on success \\
\hline
{\em 0} & otherwise \\
\hline
\end{DoxyRetVals}
\Hypertarget{clock_8c_a8ac22b37088c49b5f266d0a00dcafb28}\index{clock.c@{clock.c}!core\_clock\_port\_init@{core\_clock\_port\_init}}
\index{core\_clock\_port\_init@{core\_clock\_port\_init}!clock.c@{clock.c}}
\doxysubsubsection{\texorpdfstring{core\_clock\_port\_init()}{core\_clock\_port\_init()}}
{\footnotesize\ttfamily \label{clock_8c_a8ac22b37088c49b5f266d0a00dcafb28} 
void core\+\_\+clock\+\_\+port\+\_\+init (\begin{DoxyParamCaption}\item[{GPIO\+\_\+\+Type\+Def \texorpdfstring{$\ast$}{*}}]{port}{}\end{DoxyParamCaption})}



Initializes port clock for selected port. 


\begin{DoxyParams}{Parameters}
{\em port} & Port to initialize clock for \\
\hline
\end{DoxyParams}
\Hypertarget{clock_8c_a909c55093b5c9d09f4edf03948a0642d}\index{clock.c@{clock.c}!core\_clock\_RTC\_init@{core\_clock\_RTC\_init}}
\index{core\_clock\_RTC\_init@{core\_clock\_RTC\_init}!clock.c@{clock.c}}
\doxysubsubsection{\texorpdfstring{core\_clock\_RTC\_init()}{core\_clock\_RTC\_init()}}
{\footnotesize\ttfamily \label{clock_8c_a909c55093b5c9d09f4edf03948a0642d} 
bool core\+\_\+clock\+\_\+\+RTC\+\_\+init (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}



Enable the external 32.\+768k\+Hz oscillator and set the RTC clock to it. 


\begin{DoxyRetVals}{Return values}
{\em 1} & \\
\hline
\end{DoxyRetVals}
\Hypertarget{clock_8c_a4dfc43b43b5975284563a397da6a3d56}\index{clock.c@{clock.c}!core\_clock\_USART\_init@{core\_clock\_USART\_init}}
\index{core\_clock\_USART\_init@{core\_clock\_USART\_init}!clock.c@{clock.c}}
\doxysubsubsection{\texorpdfstring{core\_clock\_USART\_init()}{core\_clock\_USART\_init()}}
{\footnotesize\ttfamily \label{clock_8c_a4dfc43b43b5975284563a397da6a3d56} 
bool core\+\_\+clock\+\_\+\+USART\+\_\+init (\begin{DoxyParamCaption}\item[{USART\+\_\+\+Type\+Def \texorpdfstring{$\ast$}{*}}]{usart}{}\end{DoxyParamCaption})}



Set a USART clock to PCLK1 and enable it. 


\begin{DoxyParams}{Parameters}
{\em usart\+\_\+num} & USART module number \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em 1} & if usart\+\_\+num is a valid USART module \\
\hline
{\em 0} & otherwise \\
\hline
\end{DoxyRetVals}
