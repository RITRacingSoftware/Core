<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Core: /home/matthias/racing/core/src/driver/Src/timeout.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="register_tables.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Core
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_4db3a2f7aa3a8b9901e70dfeb2571af9.html">driver</a></li><li class="navelem"><a class="el" href="dir_bd43694d282a1a6821503b447b4f5643.html">Src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">timeout.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Core timeout library.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;timeout.h&quot;</code><br />
<code>#include &quot;core_config.h&quot;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;stm32g4xx_hal.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac6773f5872b12a63f6962ff3ad77e293"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="timeout_8c.html#ac6773f5872b12a63f6962ff3ad77e293">core_timeout_insert</a> (<a class="el" href="structcore__timeout__s.html">core_timeout_t</a> *timeout)</td></tr>
<tr class="memdesc:ac6773f5872b12a63f6962ff3ad77e293"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a timeout to the internal list of timeouts to be monitored.  <a href="timeout_8c.html#ac6773f5872b12a63f6962ff3ad77e293">More...</a><br /></td></tr>
<tr class="separator:ac6773f5872b12a63f6962ff3ad77e293"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b2c1a1fb196b899718eb0ec450b87ab"><td class="memItemLeft" align="right" valign="top"><a id="a4b2c1a1fb196b899718eb0ec450b87ab"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="timeout_8c.html#a4b2c1a1fb196b899718eb0ec450b87ab">core_timeout_start_all</a> ()</td></tr>
<tr class="memdesc:a4b2c1a1fb196b899718eb0ec450b87ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable all timeouts currently in the internal timeout list. <br /></td></tr>
<tr class="separator:a4b2c1a1fb196b899718eb0ec450b87ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fdb5d680ce585ff6d985fdac54b773e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="timeout_8c.html#a4fdb5d680ce585ff6d985fdac54b773e">core_timeout_reset_by_module_ref</a> (void *module, uint32_t ref)</td></tr>
<tr class="memdesc:a4fdb5d680ce585ff6d985fdac54b773e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset a timeout given the module and the refernce number.  <a href="timeout_8c.html#a4fdb5d680ce585ff6d985fdac54b773e">More...</a><br /></td></tr>
<tr class="separator:a4fdb5d680ce585ff6d985fdac54b773e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e86c2b81596b983b91c0e5ba775b599"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="timeout_8c.html#a2e86c2b81596b983b91c0e5ba775b599">core_timeout_reset</a> (<a class="el" href="structcore__timeout__s.html">core_timeout_t</a> *timeout)</td></tr>
<tr class="memdesc:a2e86c2b81596b983b91c0e5ba775b599"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset a timeout given a pointer to the timeout struct.  <a href="timeout_8c.html#a2e86c2b81596b983b91c0e5ba775b599">More...</a><br /></td></tr>
<tr class="separator:a2e86c2b81596b983b91c0e5ba775b599"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20d256d89e7597b03051d8c5ceb1bdb2"><td class="memItemLeft" align="right" valign="top"><a id="a20d256d89e7597b03051d8c5ceb1bdb2"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="timeout_8c.html#a20d256d89e7597b03051d8c5ceb1bdb2">core_timeout_check_all</a> ()</td></tr>
<tr class="memdesc:a20d256d89e7597b03051d8c5ceb1bdb2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check all timeouts currently stored in the internal timeout list. <br /></td></tr>
<tr class="separator:a20d256d89e7597b03051d8c5ceb1bdb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3f17e94126a67496363bcef24255709" id="r_ac3f17e94126a67496363bcef24255709"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac3f17e94126a67496363bcef24255709">core_timeout_suspend</a> (<a class="el" href="structcore__timeout__s.html">core_timeout_t</a> *timeout)</td></tr>
<tr class="memdesc:ac3f17e94126a67496363bcef24255709"><td class="mdescLeft">&#160;</td><td class="mdescRight">Suspend timeout.  <br /></td></tr>
<tr class="separator:ac3f17e94126a67496363bcef24255709"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad57951d17673691b4d5608bff8829d2a" id="r_ad57951d17673691b4d5608bff8829d2a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad57951d17673691b4d5608bff8829d2a">core_timeout_resume</a> (<a class="el" href="structcore__timeout__s.html">core_timeout_t</a> *timeout)</td></tr>
<tr class="memdesc:ad57951d17673691b4d5608bff8829d2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resume suspended timeout.  <br /></td></tr>
<tr class="separator:ad57951d17673691b4d5608bff8829d2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Core timeout library. </p>
<p>This core library component can be used to set timeouts for both software events and core library events. Timeouts are specified by a core_timeout_t struct.</p>
<h2><a class="anchor" id="autotoc_md12"></a>
Typical initialization</h2>
<ol type="1">
<li>Initialize a core_timeout_t struct for each timeout<ul>
<li>Set the <code>timeout</code> member to the desired timeout length in milliseconds</li>
<li>Set the <code>callback</code> member to the timeout's callback function. When the function is called, a pointer to the struct defining the timeout that called the callback function is passed to it.</li>
<li>Set the <code>module</code> and <code>ref</code> members. See below</li>
</ul>
</li>
<li>Add the timeout structs to the internal list with <a class="el" href="timeout_8c.html#ac6773f5872b12a63f6962ff3ad77e293" title="Add a timeout to the internal list of timeouts to be monitored.">core_timeout_insert()</a></li>
<li>Start all of the timeouts with <a class="el" href="timeout_8c.html#a4b2c1a1fb196b899718eb0ec450b87ab" title="Enable all timeouts currently in the internal timeout list.">core_timeout_start_all()</a></li>
<li>Call <code>core_timeout_check_all</code> at regular intervals. If a timeout has elapsed, the handler is called. Timeouts are checked in the order they are added.</li>
<li>Reset timeouts as needed with the <a class="el" href="timeout_8c.html#a2e86c2b81596b983b91c0e5ba775b599" title="Reset a timeout given a pointer to the timeout struct.">core_timeout_reset()</a> function.</li>
</ol>
<h2><a class="anchor" id="autotoc_md13"></a>
module and ref</h2>
<p>The <code>module</code> and <code>ref</code> members of the core_timeout_t struct can be used to define timeouts that are automatically reset by other core library components. To reset these timeouts, the <a class="el" href="timeout_8c.html#a4fdb5d680ce585ff6d985fdac54b773e" title="Reset a timeout given the module and the refernce number.">core_timeout_reset_by_module_ref()</a> function is used. The <code>module</code> member is set to a register struct defined by the HAL (e.g. FDCAN1, SPI1, USART3, etc.). The meaning of <code>ref</code> depends on the selected module. Currently, the modules that support this feature are:</p><ol type="1">
<li><code>FDCAN1</code>, <code>FDCAN2</code>, and <code>FDCAN3</code>: The timeout is reset when a frame with an ID equal to the value of <code>ref</code> is received</li>
</ol>
<p>Timeouts with a <code>module</code> not in the above list will never be reset by the core library. Thus, the user can define timeouts where <code>module</code> is NULL or equal to a custom value and reset them using the <a class="el" href="timeout_8c.html#a4fdb5d680ce585ff6d985fdac54b773e" title="Reset a timeout given the module and the refernce number.">core_timeout_reset_by_module_ref()</a> function. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ac6773f5872b12a63f6962ff3ad77e293"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6773f5872b12a63f6962ff3ad77e293">&#9670;&nbsp;</a></span>core_timeout_insert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void core_timeout_insert </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcore__timeout__s.html">core_timeout_t</a> *&#160;</td>
          <td class="paramname"><em>timeout</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a timeout to the internal list of timeouts to be monitored. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">timeout</td><td>Pointer to the timeout </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a2e86c2b81596b983b91c0e5ba775b599"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e86c2b81596b983b91c0e5ba775b599">&#9670;&nbsp;</a></span>core_timeout_reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void core_timeout_reset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcore__timeout__s.html">core_timeout_t</a> *&#160;</td>
          <td class="paramname"><em>timeout</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset a timeout given a pointer to the timeout struct. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">timeout</td><td>Pointer to the timeout being reset </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a4fdb5d680ce585ff6d985fdac54b773e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fdb5d680ce585ff6d985fdac54b773e">&#9670;&nbsp;</a></span>core_timeout_reset_by_module_ref()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void core_timeout_reset_by_module_ref </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>module</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ref</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset a timeout given the module and the refernce number. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">module</td><td>Module that is calling this function </td></tr>
    <tr><td class="paramname">ref</td><td>Reference number </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad57951d17673691b4d5608bff8829d2a" name="ad57951d17673691b4d5608bff8829d2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad57951d17673691b4d5608bff8829d2a">&#9670;&#160;</a></span>core_timeout_resume()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void core_timeout_resume </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcore__timeout__s.html">core_timeout_t</a> *</td>          <td class="paramname"><span class="paramname"><em>timeout</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resume suspended timeout. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">timeout</td><td>Pointer to the timeout being resumed </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ac3f17e94126a67496363bcef24255709" name="ac3f17e94126a67496363bcef24255709"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3f17e94126a67496363bcef24255709">&#9670;&#160;</a></span>core_timeout_suspend()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void core_timeout_suspend </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcore__timeout__s.html">core_timeout_t</a> *</td>          <td class="paramname"><span class="paramname"><em>timeout</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Suspend timeout. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">timeout</td><td>Pointer to the timeout being suspended </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
